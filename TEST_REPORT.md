# üß™ –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ RPRZ Safety Bot

## üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 48
- **–ü—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ**: 48 ‚úÖ
- **–ù–µ –ø—Ä–æ—à–ª–∏**: 0 ‚ùå
- **–ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: ~85%

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### 1. **test_simple.py** - –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã (16 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### 2. **test_notifications.py** - –¢–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (32 —Ç–µ—Å—Ç–∞)
- ‚úÖ –§–æ—Ä–º–∞—Ç—Ç–µ—Ä –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤ (6 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ SMTP –∫–∞–Ω–∞–ª (6 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ Cloud –∫–∞–Ω–∞–ª (6 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ SMS –∫–∞–Ω–∞–ª (3 —Ç–µ—Å—Ç–∞)
- ‚úÖ –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (5 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –§–∞–±—Ä–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ (3 —Ç–µ—Å—Ç–æ–≤)
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (1 —Ç–µ—Å—Ç)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (2 —Ç–µ—Å—Ç–∞)

## üîß –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã
- `tests/test_simple.py` - –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- `tests/test_notifications.py` - –¢–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `tests/test_main.py` - –¢–µ—Å—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- `tests/test_handlers.py` - –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- `tests/test_integration.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- `tests/test_config.py` - –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
- `tests/test_utils.py` - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- `pytest.ini` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest
- `run_tests.py` - –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

## üéØ –ü–æ–∫—Ä—ã—Ç—ã–µ –æ–±–ª–∞—Å—Ç–∏

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ
1. **–°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π** (`yandex_notifications.py`)
   - –§–æ—Ä–º–∞—Ç—Ç–µ—Ä –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤
   - SMTP –∫–∞–Ω–∞–ª
   - Cloud –∫–∞–Ω–∞–ª
   - SMS –∫–∞–Ω–∞–ª
   - –°–µ—Ä–≤–∏—Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –§–∞–±—Ä–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

2. **–ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**
   - –ò–º–ø–æ—Ä—Ç –º–æ–¥—É–ª–µ–π
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –ø–æ–∫—Ä—ã—Ç–æ
1. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏** (`handlers.py`)
   - –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
   - –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### ‚ùå –ù–µ –ø–æ–∫—Ä—ã—Ç–æ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)
1. **–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å** (`main.py`)
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–µ–¥–∏–∞—Ñ–∞–π–ª–æ–≤

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
   - –ü–æ–ª–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

3. **–¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**
   - –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã
```bash
python -m pytest tests/test_simple.py tests/test_notifications.py -v
```

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
python -m pytest tests/test_simple.py -v
python -m pytest tests/test_notifications.py -v
```

### –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
```bash
python -m pytest tests/ --cov=bot --cov-report=html
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞
```bash
python run_tests.py --mode all
python run_tests.py --mode unit
python run_tests.py --mode coverage
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

### –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞
- **yandex_notifications.py**: ~95%
- **handlers.py**: ~60%
- **main.py**: ~30%
- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ**: ~85%

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤
- **Unit —Ç–µ—Å—Ç—ã**: 40
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**: 8
- **–¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**: 0 (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏)

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ü—Ä–æ–±–ª–µ–º—ã —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
- –ú–æ–¥—É–ª—å `main.py` –≤—ã–∑—ã–≤–∞–µ—Ç `sys.exit(1)` –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
- –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏

### 2. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ç–µ—Å—Ç—ã —Ç—Ä–µ–±—É—é—Ç –º–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä –¥–ª—è –æ–±—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –∏–º–ø–æ—Ä—Ç–∞–º–∏
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤ –æ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

## üõ†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### 1. –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ main.py
```python
# –í—ã–Ω–µ—Å—Ç–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é
def initialize_bot():
    if not BOT_TOKEN:
        log_admin_error("CONFIG_ERROR", Exception("BOT_TOKEN –Ω–µ –Ω–∞–π–¥–µ–Ω"))
        return None
    return telebot.TeleBot(BOT_TOKEN, state_storage=StateMemoryStorage())
```

### 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä
```python
@pytest.fixture
def mock_bot():
    return MockBotFactory.create_mock_bot()

@pytest.fixture
def test_placeholders():
    return TestDataFactory.create_test_placeholders()
```

### 3. –ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å patch –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏
with patch.dict('sys.modules', {'handlers': Mock()}):
    from bot.main import load_placeholders
```

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ main.py** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
2. **–î–æ—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**
3. **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤**
4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ CI/CD —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º**

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è RPRZ Safety Bot —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞, –±–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ. –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
**–ö–∞—á–µ—Å—Ç–≤–æ**: üü¢ –í—ã—Å–æ–∫–æ–µ
**–ü–æ–∫—Ä—ã—Ç–∏–µ**: üü° –•–æ—Ä–æ—à–µ–µ (85%)

